<div class="showrooms-wrapper">
  <h3>Showrooms</h3>
  <p>Regional Offices</p>
  <div class="regional-offices">
    <ul>
      <% @regional_offices.each do |regional_office| %>
        <li>
          <%= regional_office.regional_office_label %>: <%= regional_office.phone_numbers.first %> 
        </li>
      <% end %>
    </ul>
  </div>

 <div id="new-canvas" >
    <canvas id="canvas" width="800" height="400"></canvas>
  </div>


  <div class="row regions">
    <ul>

      <% @regions.each do |region| %>
        <li>
          <h3>
            <%= link_to region.name, anchor: region.name %>
          </h3>
        </li>
      <% end %>
    </ul>
  </div>

  <% @regions.each do |region| %>
    <div class="showrooms-list row">
      <%= content_tag(:h3, "Showrooms in #{region.name}", id: region.name) %>
      <% region.showrooms.in_groups_of(3, false) do |showrooms| %>
        <div class="row">
          <% showrooms.each do |showroom| %>
            <%= render showroom %>
          <% end %>
        </div>
      <% end %>
    </div>
  <% end %>
</div>

<script>
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');

  draw_bg();
  mousePosition();

  var us_img = new Image();
  us_img.src = '/images/map/map_north_america.png';

  var bg_img = new Image();
  bg_img.src = '/images/map/map_bg.jpg';

  function draw_bg() {
    
    var bg_img = new Image();
    bg_img.src = '/images/map/map_bg.jpg';
    
    bg_img.onload = function(){
      var width = canvas.scrollWidth;
      var height = canvas.scrollHeight;
      //for responsive
      ctx.drawImage(bg_img,0,0);
     
    };
    
    
  }

  function mousePosition(){
    function getMousePos(canvas, evt) {
        var rect = canvas.getBoundingClientRect();
        return {
          x: evt.clientX - rect.left,
          y: evt.clientY - rect.top
        };
      }

      canvas.addEventListener('mousemove', function(evt) {
        var mousePos = getMousePos(canvas, evt);

        var message = 'Mouse position: ' + mousePos.x + ',' + mousePos.y;
        
        if(mousePos.x > canvas.width/3.8 && mousePos.x < canvas.width/1.5)
        {
         draw_region(us_img);

        }else{
          draw_region(bg_img);
        }
      }, false);
  }
  function draw_region(image){
    var width = canvas.scrollWidth;
      var height = canvas.scrollHeight;
      ctx.drawImage(image,0,0);
     
  }
</script>
